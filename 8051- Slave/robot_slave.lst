C51 COMPILER V9.55   ROBOT_SLAVE                                                           04/17/2019 14:22:00 PAGE 1   


C51 COMPILER V9.55, COMPILATION OF MODULE ROBOT_SLAVE
OBJECT MODULE PLACED IN robot_slave.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE src\robot_slave.c LARGE OPTIMIZE(0,SPEED) BROWSE DEBUG OBJECTEXTEND PRIN
                    -T(.\robot_slave.lst) TABS(2) OBJECT(robot_slave.obj)

line level    source

   1          #include "spi_slave.h"
   2          #include "light_beam.h"
   3          #include "c8051F020.h"
   4          
   5          /*
   6          #############################################################################
   7                  PIN List
   8          #############################################################################
   9          *
  10          * 
  11          *
  12          * SPI = SCK -> P0.0 | MISO -> P0.1 | MOSI -> P0.2 | NSS -> P0.3
  13          *       SCK : OUT
  14          *       MISO : IN
  15          *       MOSI : OUT
  16          *       NSS : Vcc
  17          *
  18          * 
  19          *
  20          * 
  21          *
  22          * 
  23          *
  24          * 
  25          *
  26          *
  27          *
  28          *
  29          */
  30          
  31          sfr Reg = 0xFF;
  32          
  33          OUT_M2 commands = {ACQ_non,
  34                              0,
  35                              GEN_non,
  36                              0,
  37                              0,
  38                              0,
  39                              0,
  40                              Lumiere_non,
  41                              10,
  42                              20,
  43                              20,
  44                              10,
  45                              Servo_non,
  46                              0,
  47                              Photo_non,
  48                              0,
  49                              0};
  50          
  51          void Init_External_clk()
  52          {
  53   1        // Config External Osci
  54   1        OSCXCN = 0x67;
C51 COMPILER V9.55   ROBOT_SLAVE                                                           04/17/2019 14:22:00 PAGE 2   

  55   1        while(OSCXCN != 0xE7) {}
  56   1        
  57   1        // Use Exern CLK
  58   1        OSCICN = 0x08;
  59   1          
  60   1        CKCON = 0x00;
  61   1      }
  62          
  63          void Enable_Crossbar()
  64          {
  65   1        // Enable Crossbar
  66   1        XBR2 |= 0x40;
  67   1        
  68   1        
  69   1      }
  70          
  71          void Enable_general_Int()
  72          {
  73   1        EA = 1; // Enable general interruption
  74   1      }
  75          
  76          int main (void)
  77          {
  78   1        Reg = 0xDE;   // Dévalidation du watchdog 
  79   1        Reg = 0xAD;
  80   1        
  81   1        Init_External_clk();
  82   1        
  83   1        Init_SPI();
  84   1        
  85   1        Init_light_beam();
  86   1        
  87   1        Enable_Crossbar();
  88   1      
  89   1        Enable_general_Int();
  90   1        
  91   1        LED = 0;
  92   1        
  93   1        while(1)
  94   1        {
  95   2          spi_process(&commands);
  96   2          
  97   2          light_beam_process(&commands);
  98   2      
  99   2          
 100   2        }
 101   1        
 102   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =     66    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =     17    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
